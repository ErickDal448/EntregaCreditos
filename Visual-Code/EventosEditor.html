<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Créditos-Eventos-Editor</title>

    <link rel="stylesheet" href="style.css"/>
    <link rel="stylesheet" href="own-style.css"/>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+3&display=swap" rel="stylesheet">

    <style>
        input[type="checkbox"] {
            width: 25px;
            height: 25px;
        }
   </style>
    </head>
<body>
    <header>
        <!-- navbar resposiva -->
       <nav class="navbar bg-cabeza bg-body-tertiary">
           <div class="container-fluid" style="flex-wrap: nowrap;">
               <a class="navbar-brand  col-md-6" href="#" id="cabeza-a">
                   <img src="Imagenes/LogoUAS.png" alt="Logo" id="logoUAS">
                   <div class="p-logoUAS">
                       <p>Módulo de créditos</p><p>Extracurriculares</p>
                   </div>           
               </a>
               <div class="nav-item col-md-6" id="div-menu" >
                <ul class="navbar-nav me-auto mb-lg-0 col-md-12" ID="header-lista" >
                    <li class="nav-text">
                        <a class="nav-link" href="InicioEditor.html">INICIO</a>
                    </li>
                    <li class="nav-text">
                        <a class="nav-link text-pulsar">EVENTOS</a>
                    </li>
                    <li class="nav-text">
                        <a class="nav-link" href="CertificadosEditor.html">CERTIFICADOS</a>
                    </li>
                    <li class="nav-text nav-fondo">
                        <a class="nav-link" href="PerfilEditor.html">PERFIL</a>
                    </li>
                    <li>
                        <a href="Perfil.html">
                            <img src="Imagenes/IconPerfil.png" alt="Icono de perfil">
                        </a>
                    </li>
                </ul>
                <li class="nav-item dropdown  col-md-12" id="li-dropdown">
                    <a class="nav-link dropdown-toggle text-fondo" id="Dropdown" data-bs-toggle="dropdown" href="#" role="button" aria-expanded="false"><span class="navbar-toggler-icon"></span></a>
                    <ul class="dropdown-menu" id="drop-menu">
                        <li><a class="dropdown-item" href="InicioEditor.html">INICIO</a></li>
                        <li><a class="dropdown-item disabled text-fondo bg-pulsar">EVENTOS</a></li>
                        <li><a class="dropdown-item" href="CertificadosEditor.html">CERTIFICADOS</a></li>
                        <li><a class="dropdown-item" href="PerfilEditor.html">PERFIL</a></li>
                    </ul>
                </li>
                </div>
            </div>
        </nav>
   </header>
   <section class="container-fluid" id="section-info-inicio">
        <div class="card" id="card-eventos">
            <section class="filtros" id="filtros">
                <button class="btn btn-pulsar border-dark btn-small" id="BtnAggEvento" type="button" style="box-shadow: 0px 10px 30px 10px rgba(0, 0, 0, 0.25); border-radius: 40px; margin-bottom: 20px; " onclick="MostrarPostEvento()">Agregar Evento</button>
                <select class="form-select form-select-lg mb-3 bg-pulsar text-fondo" aria-label=".form-select-lg example" style="font-weight: 600; border-radius: 60px;" id="SeleccionFiltros">
                    <option value="0">Favor de seleccionar un filtro</option>
                    <option value="1">Eventos Próximos</option>
                    <option value="2">Eventos Pasados</option>
                </select>
            </section>

            <section class="Eventos-ListaSimple" style="display: none">
                <div class="card" id="card-lista-eventosSimple">
                    <div class="col-md-11" data-id="valorID" id="lista-info-eventoSimple">
                        <ul class="list-group list-group-horizontal ">
                            <li class="list-group-item AtributosEventos">Título</li>
                            <li class="list-group-item VariablesEventos text-break">{Titulo}123456789012345678901234567890123456789012345678901234567890123456789012345678901234568790</li>
                        </ul>
                        <ul class="list-group list-group-horizontal ">
                            <li class="list-group-item AtributosEventos">Fecha</li>
                            <li class="list-group-item VariablesEventos text-break">20/05/23<br>16:00</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section class="EventosTablas"  style="display: flex;">
                <div class="card" id="card-lista-eventos" style="display: none;">
                    <div class="mapa-creditos col-md-2">
                        <button class="btn btn-cancelar text-fondo" id="btnReturn" onclick="regresar()" style="border-radius: 40px; width: 90px; height: 60px; margin-top: 30px;"> 
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-left" viewBox="0 0 16 16" style="width: 40px; height: 40px;">
                                <path fill-rule="evenodd" d="M6 12.5a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-9a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v2a.5.5 0 0 1-1 0v-2A1.5 1.5 0 0 1 6.5 2h8A1.5 1.5 0 0 1 16 3.5v9a1.5 1.5 0 0 1-1.5 1.5h-8A1.5 1.5 0 0 1 5 12.5v-2a.5.5 0 0 1 1 0v2z"/>
                                <path fill-rule="evenodd" d="M.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L1.707 7.5H10.5a.5.5 0 0 1 0 1H1.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
                            </svg>
                        </button>
                        <a href="" target="_blank" id="EventoEnlace-mapa">
                            <button class="btn btn-cabeza" id="BotonMapa" type="button" data-bs-toggle="collapse" data-bs-target="#collapseWidthExample" aria-expanded="false" aria-controls="collapseWidthExample">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-geo-alt-fill" viewBox="0 0 16 16">
                                    <path d="M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10zm0-7a3 3 0 1 1 0-6 3 3 0 0 1 0 6z"/>
                                </svg>
                            </button>
                        </a>
                        <div class="badge bg-pulsar text-wrap font-weight-bold fs-6" style="margin-bottom: 20px; border-radius: 50px;" id="EventoCreditos">
                            Creditos: 0.5C.
                          </div>
                    </div>
                    

                    <div class="col-md-9" id="lista-info-evento">
                        <button class="btn btn-pulsar text-fondo" id="btnEditar" style="margin-bottom: 20px;" onclick="EditPost()"> Editar </button>
                        <ul class="list-group list-group-horizontal ">
                            <li class="list-group-item AtributosEventos ">Título</li>
                            <li class="list-group-item VariablesEventos" Id="EventoTitulo">{Titulo}</li>
                        </ul>
                        <ul class="list-group list-group-horizontal">
                            <li class="list-group-item AtributosEventos">Tipo</li>
                            <li class="list-group-item VariablesEventos text-break" Id="EventoTipo">{Tipo}</li>
                        </ul>
                        <ul class="list-group list-group-horizontal">
                            <li class="list-group-item AtributosEventos">Descripción</li>
                            <li class="list-group-item VariablesEventos text-break" id="EventoDescripcion">{Descripcion} 123456789012345678901234567890123456789012345678901234567890123456789012345678901234568790</li>
                        </ul>
                        <ul class="list-group list-group-horizontal">
                            <li class="list-group-item AtributosEventos">Fecha</li>
                            <li class="list-group-item VariablesEventos">
                                <input type="datetime-local" class="form-control" id="EventoFecha" name="fecha-hora" readonly>
                            </li>
                        </ul>
                        <button class="btn btn-pulsar text-fondo" id="btnEditar" style="margin-top: 20px;" onclick="ListPost()"> Lista de Asistencia </button>
                    </div>
                </div>
            </section>

            <section class="PostEdit">
                <div class="card" id="card-eventos-post" style="display: none;">
                    <section>
                        <button class="btn btn-cancelar text-fondo" id="btnReturnPost" onclick="regresarPost()" style="border-radius: 40px; width: 90px; height: 60px; margin-bottom: 20px;"> 
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-left" viewBox="0 0 16 16" style="width: 40px; height: 40px;">
                                <path fill-rule="evenodd" d="M6 12.5a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-9a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v2a.5.5 0 0 1-1 0v-2A1.5 1.5 0 0 1 6.5 2h8A1.5 1.5 0 0 1 16 3.5v9a1.5 1.5 0 0 1-1.5 1.5h-8A1.5 1.5 0 0 1 5 12.5v-2a.5.5 0 0 1 1 0v2z"/>
                                <path fill-rule="evenodd" d="M.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L1.707 7.5H10.5a.5.5 0 0 1 0 1H1.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
                            </svg>
                        </button>
                        <div class="mb-3">
                            <label for="FormEventoTitulo " class="form-label"> Título </label>
                            <input type="text" class="form-control " id="FormEventoTitulo" placeholder="Título">
                        </div>
                        <div class="mb-3">
                            <label for="FormEventoTipoEvento" class="form-label"> Tipos Evento </label>
                            <select class="form-select form-select-lg mb-3" id="FormEventoTipoEvento" aria-label=".form-select-lg example" style="font-weight: 600; border-radius: 60px;">
                                <option value="Otro">Otro</option>
                            </select>

                            <script>
                                const selectElement = document.getElementById('FormEventoTipoEvento');
                                fetch(`https://localhost:7220/api/TablaCreditos/api/TablaCertificados?institucion=${encodeURIComponent(localStorage.getItem('UserInstitucion'))}`)
                                    .then(response => response.json())
                                    .then(data => {
                                        data.forEach(item => {
                                            const optionElement = document.createElement('option');
                                            optionElement.value = item.id;
                                            optionElement.textContent = item.nombreTC;
                                            selectElement.appendChild(optionElement);
                                        });
                                    });
                            </script>
                        </div>
                        <div class="mb-3">
                            <label for="FormEventoInfo" class="form-label"> Descripción del evento </label>
                            <input type="text" class="form-control" id="FormEventoDescripcion" placeholder="Descripción">
                        </div>
                        <div class="mb-3">
                            <label for="FormEventoInfo" class="form-label"> Mapa del evento </label>
                            <input type="text" class="form-control" id="FormEventoMapa" placeholder="Ingrese el link de googleMaps del lugar">
                        </div>
                        <div class="mb-3">
                            <label for="FormEventoFecha" class="form-label"> Fecha </label>
                            <input type="datetime-local" class="form-control" id="FormEventoFecha" name="fecha-hora">
                        </div>
                    </section>
                    <section id="section-eventos-post-img" style="display: flex; flex-direction: column; align-items: center;">
                        <img src="Imagenes/ImgCalendario.png">
                        <div class="mb-3">
                            <label for="FormEventoDescripcion" class="form-label"> Cantidad Créditos </label>
                            <input type="number" step="0.01" min="0" class="form-control" id="FormCantidadCreditos" placeholder="0 C.">
                        </div>
 
                        <script>
                            const inputElement = document.getElementById('FormCantidadCreditos');

                            let data;

                            fetch(`https://localhost:7220/api/TablaCreditos/api/TablaCertificados?institucion=${encodeURIComponent(localStorage.getItem('UserInstitucion'))}`)
                                .then(response => response.json())
                                .then(responseData => {
                                    data = responseData;
                                    data.forEach(item => {
                                        const optionElement = document.createElement('option');
                                        optionElement.value = item.id;
                                        optionElement.textContent = item.nombreTC;
                                        selectElement.appendChild(optionElement);
                                    });
                                });

                                selectElement.addEventListener('change', event => {
                            const selectedValue = event.target.value;
                            if (selectedValue === 'Otro') {
                                inputElement.disabled = false;
                                inputElement.value = '';
                            } else {
                                inputElement.disabled = true;
                                const selectedItem = data.find(item => item.id === parseInt(selectedValue));
                                if (selectedItem) {
                                    inputElement.value = selectedItem.creditosValor;
                                }
                            }
                        });


                        </script>
                    </section>
                    <section style="display: flex; justify-content: space-around;"> 
                        <button class="btn btn-cancelar btn-normal" id="BtnDropEvento" type="button" style="border-radius: 40px; display: none;">
                            Eliminar
                        </button>
                        <button class="btn btn-pulsar btn-normal" id="BtnEnviarEvento" type="button" style="border-radius: 40px; font-weight: bold;">
                            Enviar
                        </button>
                    </section>
                </div>
            </section>
        </div>  
   </section>
   
   <section id="listaAsistencia" style="display: none; align-items: center; justify-content: center;">
        <div class="card bg-cabeza" id="card-eventos-post">
            <div>
                <button class="btn btn-cancelar text-fondo" id="btnReturnPost" onclick="regresarAsistencia()" style="border-radius: 40px; width: 90px; height: 60px; margin-bottom: 0px;"> 
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-left" viewBox="0 0 16 16" style="width: 40px; height: 40px;">
                    <path fill-rule="evenodd" d="M6 12.5a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-9a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v2a.5.5 0 0 1-1 0v-2A1.5 1.5 0 0 1 6.5 2h8A1.5 1.5 0 0 1 16 3.5v9a1.5 1.5 0 0 1-1.5 1.5h-8A1.5 1.5 0 0 1 5 12.5v-2a.5.5 0 0 1 1 0v2z"/>
                    <path fill-rule="evenodd" d="M.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L1.707 7.5H10.5a.5.5 0 0 1 0 1H1.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
                </svg>
                </button>
                <h4 class="text-fondo text-center font-weight-bold" id="TituloAsistencia"> Lista de asistencia del evento: {Titulo Evento}</h4>
                <script>
                    
                </script>
            </div>
            
            <section style="margin-bottom: 20px; display: flex; align-items: center;">
                <div class="col-md-5">
                    <label for="formGroupExampleInput2" class="form-label badge bg-fondo text-wrap font-weight-bold text-dark fs-6">Grado</label>
                    <select id="inputStateGrado" class="form-select bg-pulsar text-fondo">
                        <option>Seleccione Grado</option>
                    </select>
                </div>
                <div class="col-md-5">
                    <label for="formGroupExampleInput2" class="form-label badge bg-fondo text-wrap font-weight-bold text-dark fs-6">Grupo</label>
                    <select id="inputStateGrupo" class="form-select bg-pulsar text-fondo">
                        <option>Seleccione Grupo</option>
                    </select>
                </div>
                <script>
                    function loadGrados() {
                    const institucion = localStorage.getItem('UserInstitucion'); 
                    fetch(`https://localhost:7220/api/MostrarAlumnosGradoGrupo/MostrarGrados/${institucion}`)
                        .then(response => response.json())
                        .then(data => {
                            console.log(institucion);
                            const grados = data.map(item => item.grados); // Mapea el arreglo de objetos a un arreglo de grados
                            console.log(grados);
                            const selectGrado = document.querySelector('#inputStateGrado');
                            for (const grado of grados) {
                                const option = document.createElement('option');
                                option.value = grado;
                                option.textContent = grado;
                                selectGrado.appendChild(option);
                            }
                        });
                    }
                    function loadGrupos() {
                    const institucion = localStorage.getItem('UserInstitucion'); 
                    fetch(`https://localhost:7220/api/MostrarAlumnosGradoGrupo/MostrarGrupos/${institucion}`)
                        .then(response => response.json())
                        .then(data => {
                            console.log(institucion);
                            const grupos = data.map(item => item.grupos); // Mapea el arreglo de objetos a un arreglo de grados
                            console.log(grupos);
                            const selectGrado = document.querySelector('#inputStateGrupo');
                            for (const grupo of grupos) {
                                const option = document.createElement('option');
                                option.value = grupo;
                                option.textContent = grupo;
                                selectGrado.appendChild(option);
                            }
                        });
                    }
                loadGrados();
                loadGrupos();
                </script>
            </section>
            <table class="table class text-fondo">
                <thead class="text-wrap bg-pulsar text-dark">
                  <tr>
                    <th scope="col" class="Numlista">#</th>
                    <th scope="col" class="ListaNombreAlumno">Alumno</th>
                    <th scope="col"  class="Asistencia">Asistió</th>
                  </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
            <div class="div-enviarsesion" >
                <button class="btn btn-pulsar border-dark btn-normal" type="button" style="box-shadow: 0px 10px 30px 10px rgba(0, 0, 0, 0.25); border-radius: 40px; " id="EnviarLista" >Enviar Lista</button>
            </div>
        </div>
        <script>
            async function getAlumnos(grado, grupo, institucion) {
                const response = await fetch(`https://localhost:7220/api/MostrarAlumnosGradoGrupo/AlumnoGradoGrupo/${grado}/${grupo}/${institucion}`);
                const data = await response.json();
                return data;
            }

            function addCheckboxEventListeners() {
                const checkboxes = document.querySelectorAll('table input[type="checkbox"]');
                checkboxes.forEach(function(checkbox) {
                    checkbox.addEventListener('change', function() {
                        if (this.checked) {
                            this.classList.add('bg-pulsar');
                            this.classList.remove('bg-cancelar');
                        } else {
                            this.classList.add('bg-cancelar');
                            this.classList.remove('bg-pulsar');
                        }
                    });
                });
            }

            function loadAlumnos() {
                const selectGrado = document.querySelector('#inputStateGrado');
                const grado = selectGrado.value;
                const selectGrupo = document.querySelector('#inputStateGrupo');
                const grupo = selectGrupo.value;
                const institucion = localStorage.getItem('UserInstitucion'); 
                fetch(`https://localhost:7220/api/MostrarAlumnosGradoGrupo/AlumnoGradoGrupo/${grado}/${grupo}/${institucion}`)
                    .then(response => response.json())
                    .then(data => {
                        const alumnos = data;
                        const tbody = document.querySelector('tbody');
                        tbody.innerHTML = '';
                        let count = 1;
                        for (const alumno of alumnos) {
                            const tr = document.createElement('tr');
                            tr.innerHTML = `
                                <th scope="row" class="Numlista">${count}</th>
                                <td class="ListaNombreAlumno ">${alumno.nombre} ${alumno.apellidos}</td>
                                <td class="Asistencia"><input class="form-check-input bg-cancelar" type="checkbox" value="${alumno.numeroCuenta}"></td>
                            `;
                            tbody.appendChild(tr);
                            count++;
                        }
                        addCheckboxEventListeners(); // Agrega los controladores de eventos a los nuevos checkboxes
                    });
            }

            document.querySelector('#inputStateGrado').addEventListener('change', loadAlumnos);
            document.querySelector('#inputStateGrupo').addEventListener('change', loadAlumnos);

        </script>

   </section>

   
   <script src="js/functions.js"></script>
   <script>
        var TipoPostEvento;
    function regresar(){
        document.getElementById("card-lista-eventosSimple").style.display = "flex";
        document.getElementById("card-lista-eventos").style.display = "none";
        document.getElementById("filtros").style.display = "block";
        let listaSimpleElements = document.querySelectorAll(".Eventos-ListaSimple");
        for (let element of listaSimpleElements) {
        element.style.display = "block";
        }
    }
    function MostrarPostEvento(){
        document.getElementById("card-lista-eventosSimple").style.display = "none";
        document.getElementById("card-eventos-post").style.display = "flex";
        document.getElementById("filtros").style.display = "none";
        let listaSimpleElements = document.querySelectorAll(".Eventos-ListaSimple");
        for (let element of listaSimpleElements) {
        element.style.display = "none";
        }
        TipoPostEvento = "POST";
        console.log(TipoPostEvento);
    }  
    function regresarPost(){
        document.getElementById("card-lista-eventosSimple").style.display = "flex";
        document.getElementById("card-eventos-post").style.display = "none";
        document.getElementById("filtros").style.display = "block";
        SelectElement.value = 0;
    }
    function EditPost(){
        document.getElementById("card-lista-eventosSimple").style.display = "none";
        document.getElementById("card-eventos-post").style.display = "flex";
        document.getElementById("filtros").style.display = "none";
        document.getElementById("card-lista-eventos").style.display = "none";
        TipoPostEvento = "PUT";
        console.log(TipoPostEvento);
    }
    function ListPost(){
        document.getElementById("listaAsistencia").style.display = "flex";
        document.getElementById("card-lista-eventos").style.display = "none";
        document.getElementById("card-eventos").style.display = "none";
    }
    function regresarAsistencia(){
        document.getElementById("listaAsistencia").style.display = "none";
        document.getElementById("card-lista-eventos").style.display = "flex";
        document.getElementById("card-eventos").style.display = "flex";

    }

    

    
    </script>


    <script>
    let SelectElement = document.getElementById('SeleccionFiltros');
    
    SelectElement.addEventListener("change", function() {
        //Obtener filtro
        let filtro = SelectElement.value;
        if(filtro == "1" || filtro == "2"){
            if(filtro == "1"){
                filtro = "EventosProximos";
            }
            if(filtro == "2"){
                filtro = "EventosPasados";
            }
            // Obtener los datos de los eventos desde la API utilizando el filtro seleccionado
            fetch(`https://localhost:7220/api/` + filtro + `/api/` + filtro + `?institucion=${encodeURIComponent(localStorage.getItem('UserInstitucion'))}`)
            .then(response => response.json())
            .then(eventos => {
                // Generar el contenido de la sección Eventos-ListaSimple
                let eventosListaSimple = document.querySelector(".Eventos-ListaSimple");
                eventosListaSimple.style.display = "block";
                eventosListaSimple.innerHTML = "";

                for (let evento of eventos) {
                    let eventoElement = document.createElement("div");
                    eventoElement.className = "card";
                    eventoElement.id = "card-lista-eventosSimple";
                    eventoElement.onclick = function() {
                    MostrarInfo(evento.idEvento);
                    console.log(evento.idEvento);
                    };
                    eventoElement.innerHTML = `
                    <div class="col-md-11" data-id="${evento.idEvento}" id="lista-info-eventoSimple">
                        <ul class="list-group list-group-horizontal ">
                        <li class="list-group-item AtributosEventos">Título</li>
                        <li class="list-group-item VariablesEventos text-break">${evento.nombre}</li>
                        </ul>
                        <ul class="list-group list-group-horizontal ">
                        <li class="list-group-item AtributosEventos">Fecha</li>
                        <li class="list-group-item VariablesEventos text-break">${evento.fecha}</li>
                        </ul>
                    </div>
                    `;
                    eventosListaSimple.appendChild(eventoElement);
                }
            });
        }
        if (filtro == "3"){
            fetch(`https://localhost:7220/api/EventosRealizados/api/EventosRealizados?NumUsuario=${encodeURIComponent(localStorage.getItem('UserNumCuenta'))}`)
            .then(response => response.json())
            .then(eventos => {
                // Generar el contenido de la sección Eventos-ListaSimple
                let eventosListaSimple = document.querySelector(".Eventos-ListaSimple");
                eventosListaSimple.style.display = "block";
                eventosListaSimple.innerHTML = "";

                for (let evento of eventos) {
                    let eventoElement = document.createElement("div");
                    eventoElement.className = "card";
                    eventoElement.id = "card-lista-eventosSimple";
                    eventoElement.onclick = function() {
                    MostrarInfo(evento.idEvento);
                    console.log(evento.idEvento);
                    };
                    eventoElement.innerHTML = `
                    <div class="col-md-11" data-id="${evento.idEvento}" id="lista-info-eventoSimple">
                        <ul class="list-group list-group-horizontal ">
                        <li class="list-group-item AtributosEventos">Título</li>
                        <li class="list-group-item VariablesEventos text-break">${evento.nombre}</li>
                        </ul>
                        <ul class="list-group list-group-horizontal ">
                        <li class="list-group-item AtributosEventos">Fecha</li>
                        <li class="list-group-item VariablesEventos text-break">${evento.fecha}</li>
                        </ul>
                    </div>
                    `;
                    eventosListaSimple.appendChild(eventoElement);
                }
            });

        }
        if(filtro == "0"){
            let eventosListaSimple = document.querySelector(".Eventos-ListaSimple");
                eventosListaSimple.style.display = "none";
        }
    });
    var IdEventoGlobal = 0;
    function MostrarInfo(idEvento) {
        let Titulo = document.getElementById("TituloAsistencia");
    // Obtener los detalles del evento con el ID especificado desde la API
    console.log(idEvento + " Check");
    IdEventoGlobal = idEvento;
    fetch("https://localhost:7220/api/InfoEventos/api/EventosInfo?IdEvento=" + idEvento)
        .then(response => response.json())
        .then(evento => {

            console.log(evento);
            // Mostrar la información detallada del evento
            let listaSimpleElements = document.querySelectorAll(".Eventos-ListaSimple");
            for (let element of listaSimpleElements) {
            element.style.display = "none";
            }
            document.getElementById("card-lista-eventos").style.display = "flex";
            
            document.getElementById("filtros").style.display = "none";

            // Actualizar el contenido de la sección con la información detallada del evento
            document.getElementById("EventoEnlace-mapa").href = evento[0].mapa;
            document.getElementById("EventoCreditos").textContent = "Créditos= " + evento[0].creditos;
            document.getElementById("EventoTitulo").textContent = evento[0].nombre;
            document.getElementById("EventoTipo").textContent = evento[0].nombreTc;
            document.getElementById("EventoDescripcion").textContent = evento[0].descripcion;
            document.getElementById("EventoFecha").value = evento[0].fecha;
            
            Titulo.textContent = "Lista de asistencia del evento: " + evento[0].nombre
        });
    }
    </script> 
    <script>
        const btnEnviar = document.querySelector('#BtnEnviarEvento');
        const inputTitulo = document.querySelector('#FormEventoTitulo');
        const selectTipoEvento = document.querySelector('#FormEventoTipoEvento');
        const inputDescripcion = document.querySelector('#FormEventoDescripcion');
        const inputMapa = document.querySelector('#FormEventoMapa');
        const inputFecha = document.querySelector('#FormEventoFecha');
        const inputCreditos = document.querySelector('#FormCantidadCreditos');
        
        btnEnviar.addEventListener('click', () => {

            const llenarTitulo = document.getElementById('FormEventoTitulo');
            const llenarDescripcion = document.getElementById('FormEventoDescripcion');
            const llenarMapa = document.getElementById('FormEventoMapa');
            const llenarFecha = document.getElementById('FormEventoFecha');
            const llenarCreditos = document.getElementById('FormCantidadCreditos');

            // Verificar si alguno de los campos está vacío
            if (!llenarTitulo.value || !llenarDescripcion.value || !llenarMapa.value || !llenarFecha.value ) {
                // Si alguno de los campos está vacío, mostrar un mensaje de alerta al usuario
                alert('Favor de llenar todos los apartados');
                return false;
            }

            if(llenarCreditos.value == 0)
            {
                alert('Favor de llenar el apartado de tipos de creditos o darle valor al evento');
                return false;
            }


            let idEvento;
            if (TipoPostEvento === "POST") {
                idEvento = 0;
            } else if (TipoPostEvento === "PUT") {
                idEvento = IdEventoGlobal;
            }

            const data = {
                idEvento: idEvento,
                nombre: inputTitulo.value,
                idTipo: selectTipoEvento.value,
                descripcion: inputDescripcion.value,
                fecha: inputFecha.value,
                estado: "none",
                creditos: inputCreditos.value,
                mapa: inputMapa.value,
                institucion: (localStorage.getItem("UserInstitucion"))
            };

        if (TipoPostEvento === "POST") {
            // Enviar la información al servidor como un nuevo evento
            fetch('https://localhost:7220/api/EventosInfoPost/CrearEvento', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(data)
            })
            .then(response => response.json())
            .then(data => {
                // Manejar la respuesta del servidor
                console.log("Creado con éxito");
                regresarPost();
            })
            .catch(error => {
                // Manejar el error
                console.error(error);
                regresarPost();
            });
        } else if (TipoPostEvento === "PUT") {
            // Enviar la información actualizada al servidor
            fetch(`https://localhost:7220/api/EventosInfoPost/EditarEvento/${IdEventoGlobal}`, {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(data)
            })
            .then(response => response.text())
            .then(text => {
                console.log(text);
                return JSON.parse(text);
            })
            .then(data => {
                // Manejar la respuesta del servidor
                console.log("Actualizado con éxito");
                console.log(IdEventoGlobal);
                regresarPost();
            })
            .catch(error => {
                // Manejar el error
                console.error(error);
                regresarPost();
            });
        }
        });
    </script>  

    <script>
        const editButton = document.getElementById("btnEditar");
        editButton.addEventListener('click', () =>{
            const eventId = IdEventoGlobal;
            fetch(`https://localhost:7220/api/EventosInfoPost/${eventId}`)
            .then(response => response.json())
            .then(evento => {
                inputTitulo.value = evento.nombre,
                selectTipoEvento.value = evento.idTipo,
                selectTipoEvento.options[selectTipoEvento.selectedIndex].text = evento.nombreTc,
                inputDescripcion.value = evento.descripcion,
                inputMapa.value = evento.mapa,
                inputFecha.value = evento.fecha,
                inputCreditos.value = evento.creditos

                
            });
        });
    </script>


        
    <script>
        document.querySelector('#EnviarLista').addEventListener('click', async function() {
            // Obtener el valor del idEvento
            const idEvento = IdEventoGlobal;

            // Obtener los valores de los checkboxes seleccionados
            const checkboxes = document.querySelectorAll('table input[type="checkbox"]:checked');
            const numUsuarios = Array.from(checkboxes).map(checkbox => checkbox.value);

            // Enviar una solicitud POST para cada checkbox seleccionado
            for (const numUsuario of numUsuarios) {
                const eventoRealizado = {
                idEvento,
                numUsuario
                };
                const response = await fetch('https://localhost:7220/api/EventosRealizados/CrearEventoRealizadoDesdeVista', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(eventoRealizado)
                });
                const data = await response.json();
                console.log(data);
                regresarAsistencia();
            }
        });
    </script>
   <script>document.write('<script src="' + getBootstrapBundlePath() + '"><\/script>');</script>
   
</body>
</html>